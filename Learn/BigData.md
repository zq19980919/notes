# 整体架构
* 学到现在，一定要对整体架构有个清晰的认识，这样才能知道自己在哪里，以及下一步该怎么走。大数据的整体架构包括的到底有哪些？这些架构之间的关系是什么？每个架构可供选择的组件有哪些？每个组件的优缺点是什么？这些都需要清晰。
* 一般来说，大数据的整体架构包括：数据采集、数据存储、数据计算、数据展示。这四个部分，每个部分都有很多的组件可供选择，每个组件都有自己的优缺点，这些都需要清晰。
* 数据采集包括：日志采集、数据抓取、数据同步、数据清洗、数据ETL、数据传输等等。
* 数据存储包括：关系型数据库、非关系型数据库、分布式文件系统、分布式数据库、内存数据库、缓存数据库等等。
* 数据计算包括：批处理、流式计算、图计算、机器学习、深度学习、搜索引擎、推荐引擎等等。
* 数据展示包括：报表、图表、可视化、数据挖掘、数据分析等等。
* 同时每个组件之间还需要消息队列、任务调度、分布式协调等等。
自底向上的来理解：
* 首先是分布式文件系统，比如HDFS，HDFS是分布式文件系统的典型代表，它是Hadoop的核心组件，HDFS的出现，使得大数据的存储成本大大降低，同时也使得大数据的计算成本大大降低。可以说，HDFS是大数据的基石。具有大数据批量读写，吞吐量高；一次写入，多次读取，顺序读写等特点。缺陷（比缺点更好）：难以满足毫秒级别的低延时数据访问；不支持多用户并发写相同文件；不适用于大量小文件
* 然后是数据库层面。数据库是一个以某种有组织的方式存储的数据集合。数据固有的特点是持久化存储、有组织、可共享、可被动态地与新数据进行组合。数据库的分类：关系型数据库、非关系型数据库、分布式数据库、内存数据库、缓存数据库等等。关系型数据库的典型代表是MySQL，非关系型数据库的典型代表是MongoDB，分布式数据库的典型代表是HBase，内存数据库的典型代表是Redis，缓存数据库的典型代表是Memcached。这几个定义不是互斥的，存在着相互交叉的情况。比如，HBase既是分布式数据库，也是非关系型数据库。Redis既是内存数据库，也是缓存数据库。这些数据库之间的关系是什么？这些数据库之间的优缺点是什么？这些都需要清晰。
* 在连接文件系统和数据库之间，存在着底层数据结构，又被称为存储引擎。存储引擎的定义是：存储引擎是数据库管理系统中负责存储、检索和更新数据的软件组件。存储引擎的底层/本质/核心是数据结构，InnoDB的背后是B+树，MongoDB的背后是B树，HBase的背后是LSM树，Redis的背后是跳表。实际上，存储引擎的底层数据结构，决定了数据库的特性。比如，B+树适合范围查询，B树适合单点查询，LSM树适合写多读少，跳表适合有序集合。数据库的底层是存储引擎，存储引擎的底层是数据结构，数据结构决定了数据库的特性。这些都需要清晰。
* 什么是数据湖？什么是数据仓库？什么是仓湖一体？数据湖和数据仓库实际上都是业务上的概念，其在物理上的表达是HDFS/Hadoop,数据湖和数据仓库的区别是：数据湖是原始数据，数据仓库是加工后的数据。数据湖和数据仓库的关系是：数据湖是数据仓库的基础。数据湖和数据仓库本身就不是冲突的，而是互补的。数据湖和数据仓库的关系，就像是原材料和成品的关系。
* 在数据库之上，是数据计算。数据计算包括：批处理、流式计算、图计算、机器学习、深度学习、搜索引擎、推荐引擎等等。目前使用较多的是批处理以及流式计算，这一部分通常使用分布式计算引擎来实现。常用的分布式计算引擎包括：批处理的MapReduce、spark，流式计算的flink等。
* 为了保证数据一致性和计算开发效率，需要引入消息队列、任务调度、分布式协调等等。常用的消息队列包括：Kafka、RabbitMQ、ActiveMQ等等。常用的任务调度包括：Azkaban、Oozie、Airflow等等。常用的分布式协调包括：Zookeeper、etcd等等。同时还存在一些数据ETL工具，这些是为了将数据在各种组件之间实现抽取、转换和加载，ETL工具根据流平台和批平台的不同，有着不同的选择。比如，流平台的ETL工具有：StreamSets、Flume、Sqoop等等。批平台的ETL工具有：Kettle、Sqoop等等。特别的，针对流平台和批凭条的数据同步，还有一些专门的工具，比如datax这种离线异构数据同步框架，以及Canal这种在线MySQL数据库binlog解析工具。随着流平台的推广，Canal本身不能保持数据一致性的问题凸显，现在越来越多的企业选择Flink CDC来解决这个问题。
* 思考Impala、Hive应该放在上述哪个位置？
* 让我们来看Hive的官方定义：Apache Hive is a distributed, fault-tolerant data warehouse system that enables analytics at a massive scale. 分布式的、容错的数据仓库系统。Hive本身不存储数据，底层是依赖于HDFS和MapReduce的，虽然HiveQL是类SQL语言，但是最终会被转换为MapReduce程序。主要用于数据仓库的统计分析，不适合实时查询。
* Impala的官方定义为：Apache Impala is the open source, native analytic database for Apache Hadoop.然而这个定义没能很好阐述出Impala的特点。在文档里，Impala作出了进一步的说明：Impala provides fast, interactive SQL queries directly on your Apache Hadoop data stored in HDFS, HBase, or the Amazon Simple Storage Service (S3).Impala does not replace the batch processing frameworks built on MapReduce such as Hive.换而言之，Impala官方对自己的定位是对Hive的补充。
* 到这里，让我们对数据库/数据仓库进行进一步细致的划分：最底层的分布式文件系统，之后是数据存储引擎，再之后是数据查询引擎，这两者中间存在着数据计算引擎。数据存储引擎和数据查询引擎的区别是：数据存储引擎是底层的，数据查询引擎是上层的。数据存储引擎的底层是数据结构，数据查询引擎的底层是数据计算引擎。数据存储引擎的核心是数据结构，数据查询引擎的核心是数据计算引擎。数据存储引擎的特点是：数据结构决定了数据库的特性。数据查询引擎的特点是：数据计算引擎决定了数据库的特性。数据存储引擎的典型代表是HBase，数据查询引擎的典型代表是Hive。需要注意的是，除了底层的HDFS，近些年这些技术越来越有解耦的趋势，Hive并不一定走MapReduce，Hive也可以走Tez，Spark，Flink。这些都是可以的。这一整套的技术架构，可以组成OLAP：基于数据仓库多维模型的基础上实现的面向分析的各类操作的集合。
* 什么是OLAP？OLAP的全称是On-Line Analytical Processing，即联机分析处理。OLAP是基于数据仓库多维模型的基础上实现的面向分析的各类操作的集合。OLAP是业务层面上的内容。